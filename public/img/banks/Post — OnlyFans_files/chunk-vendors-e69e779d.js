"use strict";(self.webpackChunkof_vue=self.webpackChunkof_vue||[]).push([[47371],{558985:function(t,e,i){var r=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},n(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n;Object.defineProperty(e,"__esModule",{value:!0});var a=i(468588),o=i(628783),s=i(354417),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._validateAdd=function(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&a.Util.throw("You may only add groups and shapes to groups.")},e}(o.Container);e.Group=h,h.prototype.nodeType="Group",s._registerNode(h),a.Collection.mapMethods(h)},244415:function(t,e,i){var r=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},n(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),n;Object.defineProperty(e,"__esModule",{value:!0});var a=i(468588),o=i(628783),s=i(1455),h=i(265331),c=i(34842),l=i(197955),p=i(653774),d=i(354417),u="#",f="beforeDraw",g="draw",y=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],v=y.length,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hitCanvas=new c.HitCanvas({pixelRatio:1}),e}return r(e,t),e.prototype._setCanvasSize=function(t,e){this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._checkSmooth()},e.prototype._validateAdd=function(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&a.Util.throw("You may only add groups and shapes to a layer.")},e.prototype.getIntersection=function(t,e){var i,r,n,a;if(!this.hitGraphEnabled()||!this.isVisible())return null;for(var o=1,s=!1;;){for(r=0;r<v;r++){if(n=y[r],(a=(i=this._getIntersection({x:t.x+n.x*o,y:t.y+n.y*o})).shape)&&e)return a.findAncestor(e,!0);if(a)return a;if(s=!!i.antialiased,!i.antialiased)break}if(!s)return null;o+=1}},e.prototype._getIntersection=function(t){var e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,r=i[3],n,o;return 255===r?(n=a.Util._rgbToHex(i[0],i[1],i[2]),(o=l.shapes[u+n])?{shape:o}:{antialiased:!0}):r>0?{antialiased:!0}:{}},e.prototype.drawScene=function(t,e){var i=this.getLayer(),r=t||i&&i.getCanvas();return this._fire(f,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),o.Container.prototype.drawScene.call(this,r,e),this._fire(g,{node:this}),this},e.prototype.drawHit=function(t,e){var i=this.getLayer(),r=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),o.Container.prototype.drawHit.call(this,r,e),this},e.prototype.clear=function(t){return h.BaseLayer.prototype.clear.call(this,t),this.getHitCanvas().getContext().clear(t),this},e.prototype.enableHitGraph=function(){return this.hitGraphEnabled(!0),this},e.prototype.disableHitGraph=function(){return this.hitGraphEnabled(!1),this},e.prototype.toggleHitCanvas=function(){if(this.parent){var t=this.parent,e;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}},e.prototype.setSize=function(e){var i=e.width,r=e.height;return t.prototype.setSize.call(this,{width:i,height:r}),this.hitCanvas.setSize(i,r),this},e}(h.BaseLayer);e.Layer=_,_.prototype.nodeType="Layer",d._registerNode(_),s.Factory.addGetterSetter(_,"hitGraphEnabled",!0,p.getBooleanValidator()),a.Collection.mapMethods(_)},677939:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var r=i(468588),n=i(1455),a=i(34842),o=i(354417),s=i(770210),h=i(653774);e.ids={},e.names={};var c=function(t,i){i&&(e.ids[i]=t)};e._removeId=function(t,i){t&&e.ids[t]===i&&delete e.ids[t]},e._addName=function(t,i){i&&(e.names[i]||(e.names[i]=[]),e.names[i].push(t))},e._removeName=function(t,i){if(t){var r=e.names[t];if(r){for(var n=0;n<r.length;n++){var a;r[n]._id===i&&r.splice(n,1)}0===r.length&&delete e.names[t]}}};var l="absoluteOpacity",p="absoluteTransform",d="absoluteScale",u="canvas",f="Change",g="children",y="konva",v="listening",_="mouseenter",m="mouseleave",C="name",b="set",x="Shape",S=" ",w="stage",D="transform",A="Stage",T="visible",k=null,P=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(S),U=["scaleXChange.konva","scaleYChange.konva"].join(S),N=new r.Collection,G=1,O=function(){function t(t){var e=this;this._id=G++,this.eventListeners={},this.attrs={},this.index=0,this.parent=null,this._cache=new Map,this._lastPos=null,this._filterUpToDate=!1,this._isUnderCache=!1,this.children=N,this._dragEventId=null,this.setAttrs(t),this.on(P,(function(){e._clearCache(D),e._clearSelfAndDescendantCache(p)})),this.on(U,(function(){e._clearSelfAndDescendantCache(d)})),this.on("visibleChange.konva",(function(){e._clearSelfAndDescendantCache(T)})),this.on("listeningChange.konva",(function(){e._clearSelfAndDescendantCache(v)})),this.on("opacityChange.konva",(function(){e._clearSelfAndDescendantCache(l)}))}return t.prototype.hasChildren=function(){return!1},t.prototype.getChildren=function(){return N},t.prototype._clearCache=function(t){t?this._cache.delete(t):this._cache.clear()},t.prototype._getCache=function(t,e){var i=this._cache.get(t);return void 0===i&&(i=e.call(this),this._cache.set(t,i)),i},t.prototype._getCanvasCache=function(){return this._cache.get(u)},t.prototype._clearSelfAndDescendantCache=function(t){this._clearCache(t),this.isCached()||this.children&&this.children.each((function(e){e._clearSelfAndDescendantCache(t)}))},t.prototype.clearCache=function(){return this._cache.delete(u),this._clearSelfAndDescendantCache(),this},t.prototype.cache=function(t){var e=t||{},i={};void 0!==e.x&&void 0!==e.y&&void 0!==e.width&&void 0!==e.height||(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var n=Math.ceil(e.width||i.width),o=Math.ceil(e.height||i.height),s=e.pixelRatio,h=void 0===e.x?i.x:e.x,c=void 0===e.y?i.y:e.y,p=e.offset||0,f=e.drawBorder||!1;if(n&&o){n+=2*p,o+=2*p,h-=p,c-=p;var g=new a.SceneCanvas({pixelRatio:s,width:n,height:o}),y=new a.SceneCanvas({pixelRatio:s,width:n,height:o}),v=new a.HitCanvas({pixelRatio:1,width:n,height:o}),_=g.getContext(),m=v.getContext();return v.isCache=!0,this._cache.delete("canvas"),this._filterUpToDate=!1,!1===e.imageSmoothingEnabled&&(g.getContext()._context.imageSmoothingEnabled=!1,y.getContext()._context.imageSmoothingEnabled=!1,v.getContext()._context.imageSmoothingEnabled=!1),_.save(),m.save(),_.translate(-h,-c),m.translate(-h,-c),this._isUnderCache=!0,this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(d),this.drawScene(g,this,!0),this.drawHit(v,this,!0),this._isUnderCache=!1,_.restore(),m.restore(),f&&(_.save(),_.beginPath(),_.rect(0,0,n,o),_.closePath(),_.setAttr("strokeStyle","red"),_.setAttr("lineWidth",5),_.stroke(),_.restore()),this._cache.set(u,{scene:g,filter:y,hit:v,x:h,y:c}),this}r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.")},t.prototype.isCached=function(){return this._cache.has("canvas")},t.prototype.getClientRect=function(t){throw new Error('abstract "getClientRect" method call')},t.prototype._transformedRect=function(t,e){var i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],r,n,a,o,s=this.getAbsoluteTransform(e);return i.forEach((function(t){var e=s.point(t);void 0===r&&(r=a=e.x,n=o=e.y),r=Math.min(r,e.x),n=Math.min(n,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y)})),{x:r,y:n,width:a-r,height:o-n}},t.prototype._drawCachedSceneCanvas=function(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);var e=this._getCanvasCache();t.translate(e.x,e.y);var i=this._getCachedSceneCanvas(),r=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/r,i.height/r),t.restore()},t.prototype._drawCachedHitCanvas=function(t){var e=this._getCanvasCache(),i=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(i._canvas,0,0),t.restore()},t.prototype._getCachedSceneCanvas=function(){var t=this.filters(),e=this._getCanvasCache(),i=e.scene,n=e.filter,a=n.getContext(),o,s,h,c;if(t){if(!this._filterUpToDate){var l=i.pixelRatio;try{for(o=t.length,a.clear(),a.drawImage(i._canvas,0,0,i.getWidth()/l,i.getHeight()/l),s=a.getImageData(0,0,n.getWidth(),n.getHeight()),h=0;h<o;h++)"function"==typeof(c=t[h])?(c.call(this,s),a.putImageData(s,0,0)):r.Util.error("Filter should be type of function, but got "+typeof c+" instead. Please check correct filters")}catch(p){r.Util.error("Unable to apply filter. "+p.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return n}return i},t.prototype.on=function(t,e){if(3===arguments.length)return this._delegate.apply(this,arguments);var i=t.split(S),r=i.length,n,a,o,s,h;for(n=0;n<r;n++)s=(o=(a=i[n]).split("."))[0],h=o[1]||"",this.eventListeners[s]||(this.eventListeners[s]=[]),this.eventListeners[s].push({name:h,handler:e});return this},t.prototype.off=function(t,e){var i=(t||"").split(S),r=i.length,n,a,o,s,h,c;if(!t)for(a in this.eventListeners)this._off(a);for(n=0;n<r;n++)if(h=(s=(o=i[n]).split("."))[0],c=s[1],h)this.eventListeners[h]&&this._off(h,c,e);else for(a in this.eventListeners)this._off(a,c,e);return this},t.prototype.dispatchEvent=function(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this},t.prototype.addEventListener=function(t,e){return this.on(t,(function(t){e.call(this,t.evt)})),this},t.prototype.removeEventListener=function(t){return this.off(t),this},t.prototype._delegate=function(t,e,i){var n=this;this.on(t,(function(t){for(var a=t.target.findAncestors(e,!0,n),o=0;o<a.length;o++)(t=r.Util.cloneObject(t)).currentTarget=a[o],i.call(a[o],t)}))},t.prototype.remove=function(){return this.isDragging()&&this.stopDrag(),s.DD._dragElements.delete(this._id),this._remove(),this},t.prototype._clearCaches=function(){this._clearSelfAndDescendantCache(p),this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(d),this._clearSelfAndDescendantCache(w),this._clearSelfAndDescendantCache(T),this._clearSelfAndDescendantCache(v)},t.prototype._remove=function(){this._clearCaches();var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)},t.prototype.destroy=function(){e._removeId(this.id(),this);for(var t=(this.name()||"").split(/\s/g),i=0;i<t.length;i++){var r=t[i];e._removeName(r,this._id)}return this.remove(),this},t.prototype.getAttr=function(t){var e="get"+r.Util._capitalize(t);return r.Util._isFunction(this[e])?this[e]():this.attrs[t]},t.prototype.getAncestors=function(){for(var t=this.getParent(),e=new r.Collection;t;)e.push(t),t=t.getParent();return e},t.prototype.getAttrs=function(){return this.attrs||{}},t.prototype.setAttrs=function(t){var e,i;if(!t)return this;for(e in t)e!==g&&(i=b+r.Util._capitalize(e),r.Util._isFunction(this[i])?this[i](t[e]):this._setAttr(e,t[e]));return this},t.prototype.isListening=function(){return this._getCache(v,this._isListening)},t.prototype._isListening=function(){var t=this.listening(),e=this.getParent();return"inherit"===t?!e||e.isListening():t},t.prototype.isVisible=function(){return this._getCache(T,this._isVisible)},t.prototype._isVisible=function(t){var e=this.visible(),i=this.getParent();return"inherit"===e?!i||i===t||i._isVisible(t):t&&t!==i?e&&i._isVisible(t):e},t.prototype.shouldDrawHit=function(){var t=this.getLayer();return!t&&this.isListening()&&this.isVisible()||t&&t.hitGraphEnabled()&&this.isListening()&&this.isVisible()},t.prototype.show=function(){return this.visible(!0),this},t.prototype.hide=function(){return this.visible(!1),this},t.prototype.getZIndex=function(){return this.index||0},t.prototype.getAbsoluteZIndex=function(){var t=this.getDepth(),e=this,i=0,r,n,a,o;function s(h){for(r=[],n=h.length,a=0;a<n;a++)o=h[a],i++,o.nodeType!==x&&(r=r.concat(o.getChildren().toArray())),o._id===e._id&&(a=n);r.length>0&&r[0].getDepth()<=t&&s(r)}return e.nodeType!==A&&s(e.getStage().getChildren()),i},t.prototype.getDepth=function(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t},t.prototype.setPosition=function(t){return this.x(t.x),this.y(t.y),this},t.prototype.getPosition=function(){return{x:this.x(),y:this.y()}},t.prototype.getAbsolutePosition=function(t){for(var e=!1,i=this.parent;i;){if(i.isCached()){e=!0;break}i=i.parent}e&&!t&&(t=!0);var n=this.getAbsoluteTransform(t).getMatrix(),a=new r.Transform,o=this.offset();return a.m=n.slice(),a.translate(o.x,o.y),a.getTranslation()},t.prototype.setAbsolutePosition=function(t){var e=this._clearTransform(),i;return this.attrs.x=e.x,this.attrs.y=e.y,delete e.x,delete e.y,(i=this.getAbsoluteTransform()).invert(),i.translate(t.x,t.y),t={x:this.attrs.x+i.getTranslation().x,y:this.attrs.y+i.getTranslation().y},this.setPosition({x:t.x,y:t.y}),this._setTransform(e),this},t.prototype._setTransform=function(t){var e;for(e in t)this.attrs[e]=t[e];this._clearCache(D),this._clearSelfAndDescendantCache(p)},t.prototype._clearTransform=function(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,this._clearCache(D),this._clearSelfAndDescendantCache(p),t},t.prototype.move=function(t){var e=t.x,i=t.y,r=this.x(),n=this.y();return void 0!==e&&(r+=e),void 0!==i&&(n+=i),this.setPosition({x:r,y:n}),this},t.prototype._eachAncestorReverse=function(t,e){var i=[],r=this.getParent(),n,a;if(e&&e._id===this._id)t(this);else{for(i.unshift(this);r&&(!e||r._id!==e._id);)i.unshift(r),r=r.parent;for(n=i.length,a=0;a<n;a++)t(i[a])}},t.prototype.rotate=function(t){return this.rotation(this.rotation()+t),this},t.prototype.moveToTop=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index;return this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0},t.prototype.moveUp=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index,e;return t<this.parent.getChildren().length-1&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)},t.prototype.moveDown=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)},t.prototype.moveToBottom=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)},t.prototype.setZIndex=function(t){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&r.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this},t.prototype.getAbsoluteOpacity=function(){return this._getCache(l,this._getAbsoluteOpacity)},t.prototype._getAbsoluteOpacity=function(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t},t.prototype.moveTo=function(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this},t.prototype.toObject=function(){var t={},e=this.getAttrs(),i,n,a,o,s;for(i in t.attrs={},e)n=e[i],(s=r.Util.isObject(n)&&!r.Util._isPlainObject(n)&&!r.Util._isArray(n))||(a="function"==typeof this[i]&&this[i],delete e[i],o=a?a.call(this):null,e[i]=n,o!==n&&(t.attrs[i]=n));return t.className=this.getClassName(),r.Util._prepareToStringify(t)},t.prototype.toJSON=function(){return JSON.stringify(this.toObject())},t.prototype.getParent=function(){return this.parent},t.prototype.findAncestors=function(t,e,i){var r=[];e&&this._isMatch(t)&&r.push(this);for(var n=this.parent;n;){if(n===i)return r;n._isMatch(t)&&r.push(n),n=n.parent}return r},t.prototype.isAncestorOf=function(t){return!1},t.prototype.findAncestor=function(t,e,i){return this.findAncestors(t,e,i)[0]},t.prototype._isMatch=function(t){if(!t)return!1;if("function"==typeof t)return t(this);var e=t.replace(/ /g,"").split(","),i=e.length,n,a;for(n=0;n<i;n++)if(a=e[n],r.Util.isValidSelector(a)||(r.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),"#"===a.charAt(0)){if(this.id()===a.slice(1))return!0}else if("."===a.charAt(0)){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1},t.prototype.getLayer=function(){var t=this.getParent();return t?t.getLayer():null},t.prototype.getStage=function(){return this._getCache(w,this._getStage)},t.prototype._getStage=function(){var t=this.getParent();return t?t.getStage():void 0},t.prototype.fire=function(t,e,i){return(e=e||{}).target=e.target||this,i?this._fireAndBubble(t,e):this._fire(t,e),this},t.prototype.getAbsoluteTransform=function(t){return t?this._getAbsoluteTransform(t):this._getCache(p,this._getAbsoluteTransform)},t.prototype._getAbsoluteTransform=function(t){var e;if(t)return e=new r.Transform,this._eachAncestorReverse((function(t){var i=t.transformsEnabled();"all"===i?e.multiply(t.getTransform()):"position"===i&&e.translate(t.x()-t.offsetX(),t.y()-t.offsetY())}),t),e;e=this.parent?this.parent.getAbsoluteTransform().copy():new r.Transform;var i=this.transformsEnabled();return"all"===i?e.multiply(this.getTransform()):"position"===i&&e.translate(this.x()-this.offsetX(),this.y()-this.offsetY()),e},t.prototype.getAbsoluteScale=function(t){return t?this._getAbsoluteScale(t):this._getCache(d,this._getAbsoluteScale)},t.prototype._getAbsoluteScale=function(t){for(var e=this;e;)e._isUnderCache&&(t=e),e=e.getParent();var i=1,r=1;return this._eachAncestorReverse((function(t){i*=t.scaleX(),r*=t.scaleY()}),t),{x:i,y:r}},t.prototype.getAbsoluteRotation=function(){for(var t=this,e=0;t;)e+=t.rotation(),t=t.getParent();return e},t.prototype.getTransform=function(){return this._getCache(D,this._getTransform)},t.prototype._getTransform=function(){var t=new r.Transform,e=this.x(),i=this.y(),n=o.Konva.getAngle(this.rotation()),a=this.scaleX(),s=this.scaleY(),h=this.skewX(),c=this.skewY(),l=this.offsetX(),p=this.offsetY();return 0===e&&0===i||t.translate(e,i),0!==n&&t.rotate(n),0===h&&0===c||t.skew(h,c),1===a&&1===s||t.scale(a,s),0===l&&0===p||t.translate(-1*l,-1*p),t},t.prototype.clone=function(t){var e=r.Util.cloneObject(this.attrs),i,n,a,o,s;for(i in t)e[i]=t[i];var h=new this.constructor(e);for(i in this.eventListeners)for(a=(n=this.eventListeners[i]).length,o=0;o<a;o++)(s=n[o]).name.indexOf(y)<0&&(h.eventListeners[i]||(h.eventListeners[i]=[]),h.eventListeners[i].push(s));return h},t.prototype._toKonvaCanvas=function(t){t=t||{};var e=this.getClientRect(),i=this.getStage(),r=void 0!==t.x?t.x:e.x,n=void 0!==t.y?t.y:e.y,o=t.pixelRatio||1,s=new a.SceneCanvas({width:t.width||e.width||(i?i.width():0),height:t.height||e.height||(i?i.height():0),pixelRatio:o}),h=s.getContext();return h.save(),(r||n)&&h.translate(-1*r,-1*n),this.drawScene(s),h.restore(),s},t.prototype.toCanvas=function(t){return this._toKonvaCanvas(t)._canvas},t.prototype.toDataURL=function(t){var e=(t=t||{}).mimeType||null,i=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(e,i);return t.callback&&t.callback(r),r},t.prototype.toImage=function(t){if(!t||!t.callback)throw"callback required for toImage method config argument";var e=t.callback;delete t.callback,r.Util._urlToImage(this.toDataURL(t),(function(t){e(t)}))},t.prototype.setSize=function(t){return this.width(t.width),this.height(t.height),this},t.prototype.getSize=function(){return{width:this.width(),height:this.height()}},t.prototype.getClassName=function(){return this.className||this.nodeType},t.prototype.getType=function(){return this.nodeType},t.prototype.getDragDistance=function(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():o.Konva.dragDistance},t.prototype._off=function(t,e,i){var r=this.eventListeners[t],n,a,o;for(n=0;n<r.length;n++)if(a=r[n].name,o=r[n].handler,!("konva"===a&&"konva"!==e||e&&a!==e||i&&i!==o)){if(r.splice(n,1),0===r.length){delete this.eventListeners[t];break}n--}},t.prototype._fireChangeEvent=function(t,e,i){this._fire(t+f,{oldVal:e,newVal:i})},t.prototype.setId=function(t){var i=this.id();return e._removeId(i,this),c(this,t),this._setAttr("id",t),this},t.prototype.setName=function(t){var i=(this.name()||"").split(/\s/g),r=(t||"").split(/\s/g),n,a;for(a=0;a<i.length;a++)n=i[a],-1===r.indexOf(n)&&n&&e._removeName(n,this._id);for(a=0;a<r.length;a++)n=r[a],-1===i.indexOf(n)&&n&&e._addName(this,n);return this._setAttr(C,t),this},t.prototype.addName=function(t){if(!this.hasName(t)){var e=this.name(),i=e?e+" "+t:t;this.setName(i)}return this},t.prototype.hasName=function(t){if(!t)return!1;var e=this.name(),i;return!!e&&-1!==(e||"").split(/\s/g).indexOf(t)},t.prototype.removeName=function(t){var e=(this.name()||"").split(/\s/g),i=e.indexOf(t);return-1!==i&&(e.splice(i,1),this.setName(e.join(" "))),this},t.prototype.setAttr=function(t,e){var i=this[b+r.Util._capitalize(t)];return r.Util._isFunction(i)?i.call(this,e):this._setAttr(t,e),this},t.prototype._setAttr=function(t,e){var i=this.attrs[t];(i!==e||r.Util.isObject(e))&&(null==e?delete this.attrs[t]:this.attrs[t]=e,this._fireChangeEvent(t,i,e))},t.prototype._setComponentAttr=function(t,e,i){var r;void 0!==i&&((r=this.attrs[t])||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=i,this._fireChangeEvent(t,r,i))},t.prototype._fireAndBubble=function(t,e,i){var r;if(e&&this.nodeType===x&&(e.target=this),!((t===_||t===m)&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||"Stage"===this.nodeType&&!i))){this._fire(t,e);var n=(t===_||t===m)&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!n&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,e,i):this._fireAndBubble.call(this.parent,t,e))}},t.prototype._fire=function(t,e){var i=this.eventListeners[t],r;if(i)for((e=e||{}).currentTarget=this,e.type=t,r=0;r<i.length;r++)i[r].handler.call(this,e)},t.prototype.draw=function(){return this.drawScene(),this.drawHit(),this},t.prototype._createDragElement=function(t){var e=t?t.pointerId:void 0,i=this.getStage(),r=this.getAbsolutePosition(),n=i._getPointerById(e)||i._changedPointerPositions[0]||r;s.DD._dragElements.set(this._id,{node:this,startPointerPos:n,offset:{x:n.x-r.x,y:n.y-r.y},dragStatus:"ready",pointerId:e})},t.prototype.startDrag=function(t){var e;s.DD._dragElements.has(this._id)||this._createDragElement(t),s.DD._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},!0)},t.prototype._setDragPosition=function(t,e){var i=this.getStage()._getPointerById(e.pointerId);if(i){var n={x:i.x-e.offset.x,y:i.y-e.offset.y},a=this.dragBoundFunc();if(void 0!==a){var o=a.call(this,n,t);o?n=o:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===n.x&&this._lastPos.y===n.y||(this.setAbsolutePosition(n),this.getLayer()?this.getLayer().batchDraw():this.getStage()&&this.getStage().batchDraw()),this._lastPos=n}},t.prototype.stopDrag=function(t){var e=s.DD._dragElements.get(this._id);e&&(e.dragStatus="stopped"),s.DD._endDragBefore(t),s.DD._endDragAfter(t)},t.prototype.setDraggable=function(t){this._setAttr("draggable",t),this._dragChange()},t.prototype.isDragging=function(){var t=s.DD._dragElements.get(this._id);return!!t&&"dragging"===t.dragStatus},t.prototype._listenDrag=function(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",(function(t){var e=this,i,r;if((!(void 0!==t.evt.button)||o.Konva.dragButtons.indexOf(t.evt.button)>=0)&&!this.isDragging()){var n=!1;s.DD._dragElements.forEach((function(t){e.isAncestorOf(t.node)&&(n=!0)})),n||this._createDragElement(t)}}))},t.prototype._dragChange=function(){var t;this.attrs.draggable?this._listenDrag():(this._dragCleanup(),this.getStage()&&s.DD._dragElements.has(this._id)&&this.stopDrag())},t.prototype._dragCleanup=function(){this.off("mousedown.konva"),this.off("touchstart.konva")},t.create=function(t,e){return r.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)},t._createNode=function(e,i){var n=t.prototype.getClassName.call(e),a=e.children,s,h,c,l;if(i&&(e.attrs.container=i),o._NODES_REGISTRY[n]||(r.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape"),s=new(0,o._NODES_REGISTRY[n])(e.attrs),a)for(h=a.length,c=0;c<h;c++)s.add(t._createNode(a[c]));return s},t}();e.Node=O,O.prototype.nodeType="Node",O.prototype._attrsAffectingSize=[],n.Factory.addGetterSetter(O,"zIndex"),n.Factory.addGetterSetter(O,"absolutePosition"),n.Factory.addGetterSetter(O,"position"),n.Factory.addGetterSetter(O,"x",0,h.getNumberValidator()),n.Factory.addGetterSetter(O,"y",0,h.getNumberValidator()),n.Factory.addGetterSetter(O,"globalCompositeOperation","source-over",h.getStringValidator()),n.Factory.addGetterSetter(O,"opacity",1,h.getNumberValidator()),n.Factory.addGetterSetter(O,"name","",h.getStringValidator()),n.Factory.addGetterSetter(O,"id","",h.getStringValidator()),n.Factory.addGetterSetter(O,"rotation",0,h.getNumberValidator()),n.Factory.addComponentsGetterSetter(O,"scale",["x","y"]),n.Factory.addGetterSetter(O,"scaleX",1,h.getNumberValidator()),n.Factory.addGetterSetter(O,"scaleY",1,h.getNumberValidator()),n.Factory.addComponentsGetterSetter(O,"skew",["x","y"]),n.Factory.addGetterSetter(O,"skewX",0,h.getNumberValidator()),n.Factory.addGetterSetter(O,"skewY",0,h.getNumberValidator()),n.Factory.addComponentsGetterSetter(O,"offset",["x","y"]),n.Factory.addGetterSetter(O,"offsetX",0,h.getNumberValidator()),n.Factory.addGetterSetter(O,"offsetY",0,h.getNumberValidator()),n.Factory.addGetterSetter(O,"dragDistance",null,h.getNumberValidator()),n.Factory.addGetterSetter(O,"width",0,h.getNumberValidator()),n.Factory.addGetterSetter(O,"height",0,h.getNumberValidator()),n.Factory.addGetterSetter(O,"listening","inherit",(function(t){var e;return!0===t||!1===t||"inherit"===t||r.Util.warn(t+' is a not valid value for "listening" attribute. The value may be true, false or "inherit".'),t})),n.Factory.addGetterSetter(O,"preventDefault",!0,h.getBooleanValidator()),n.Factory.addGetterSetter(O,"filters",null,(function(t){return this._filterUpToDate=!1,t})),n.Factory.addGetterSetter(O,"visible","inherit",(function(t){var e;return!0===t||!1===t||"inherit"===t||r.Util.warn(t+' is a not valid value for "visible" attribute. The value may be true, false or "inherit".'),t})),n.Factory.addGetterSetter(O,"transformsEnabled","all",h.getStringValidator()),n.Factory.addGetterSetter(O,"size"),n.Factory.addGetterSetter(O,"dragBoundFunc"),n.Factory.addGetterSetter(O,"draggable",!1,h.getBooleanValidator()),n.Factory.backCompat(O,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),r.Collection.mapMethods(O)},498479:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var r=i(354417),n=new Map,a=void 0!==r.Konva._global.PointerEvent;function o(t){return n.get(t)}function s(t){return{evt:t,pointerId:t.pointerId}}function h(t,e){return n.get(t)===e}function c(t,e){var i;l(t),e.getStage()&&(n.set(t,e),a&&e._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function l(t,e){var i=n.get(t);if(i){var r=i.getStage();r&&r.content,n.delete(t),a&&i._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}}e.getCapturedShape=o,e.createEvent=s,e.hasPointerCapture=h,e.setPointerCapture=c,e.releaseCapture=l}}]);